## 순서
34.1 이터레이션 프로토콜

34.2 빌트인 이터러블

34.3 for…of 문

34.4 이터러블과 유사 배열 객체

34.5 이터레이션 프로토콜의 필요성

34.6 사용자 정의 이터러블


## 34.1 이터레이션 프로토콜

- 간단히
    
    순회 가능한 데이터 컬렉션(자료구조)을 만들기 위해 ECMAScript 사양에 정의하여 미리 약속한 규칙
    
    | ES6 이전 | 순회 가능한 데이터 컬렉션, 즉 배열, 문자열, 유사 배열 객체, DOM 컬렉션 등은 통일된 규약 없이 나름의 구조를 가지고 다양한 방법으로 순회 | for문, for …in문, forEach문 |
    | --- | --- | --- |
    | ES6 이후 | 순회 가능한 데이터 컬렉션을 이터레이션 프로토콜을 준수하는 이터러블로 통일하여 사용 | for …of문, 스프레드 문법, 배열 디스트럭처링 할당의 대상 |
- 이터레이션 프로토콜
    1. 이터러블 프로토콜
        - 정의
            
            Symbol.iterator를 프로퍼티 키로 사용한 메서드를 직접 구현하거나 프로토타입 체인을 통해 상속 받은 Symbol.iterator 메서드를 호출하면 이터레이터 프로토콜을 준수한 이터레이터를 반환하는 규약
            
        - 이터러블
            
            이터러블 프로토콜을 준수한 객체
            
        - 사용
            
            for …of 문으로 순회할 수 있으며 스프레드 문법과 배열 디스트럭처링 할달의 대상으로 사용
            
    2. 이터레이터 프로토콜
        - 정의
            
            이터러블의 Symbol.iterator 메서드를 호출하면 이터레이터 프로토콜을 준수한 이터레이터를 반환. 이터레이터는 next 메서드를 소유하면 next 메서드를 호출하며 이터러블을 순회하며 value와 done 프로퍼티를 갖는 이터레이터 리절트 객체를 반환하는 규약
            
        - 이터레이터
            
            이터레이터 프로토콜을 준수한 객체
            
        - 사용
            
            이터러블의 요소를 탐색하기 위한 포인터 역할
            
    

## 34.2 빌트인 이터러블

자바스크립트는 이터레이션 프로토콜을 준수한 객체인 빌트인 이터러블을 제공

## 34.3 for…of 문

이터러블을 순회하면서 이터러블 요소를 변수에 할당

- for… of문 문법
    
    ```tsx
    for (변수선언문 of 이터러블) { ... }
    ```
    
    - 내부적으로 이터레이터의 next 메서드를 호출하여 이터러블을 순회하며 next 메서드가 반환한 이터레이터 리절트 객체의 value 프로퍼티 값을 for…of문의 변수에 할당
    - 이터레이터 리절트 객체의 done 프로퍼티 값이 false이면 이터러블의 순회를 계속하고 true이면 이터러블 순회를 중단
- for… in문 문법
    
    ```tsx
    for (변수선언문 in 객체) { ... }
    ```
    
    - 객체의 프로토타입 체인 상에 존재하는 모든 프로토타입의 프로퍼티 중에서 프로퍼티 어트리뷰트 [[Enumerable]]의 값이 true인 프로퍼티를 순회하며 열거
    - 이때 프로퍼티 키가 심벌인 프로퍼티는 열거하지 않음

## 34.4 이터러블과 유사 배열 객체

- 유사 배열 객체
    - 배열처럼
        - 인덱스로 프로퍼티 값에 접근할 수 있고
            - 인덱스를 나타내는 숫자 형식의 문자열을 프로퍼티 키로 가지기 때문
        - length 프로퍼티를 갖는 객체
            - for문으로 순회
    - 그러나 이터러블이 아닌 일반 객체
        - Symbol.iterator 메서드가 없기 때문에 for …of 문으로 순회할 수 없음

- 유사 배열 객체 이면서 이터러블
    - arguments, NodeList, HTMLCollection
        - 원래는 유사 배열 객체였지만 ES6에서 이터러블이 도입되면서 Symbol.iterator 메서드를 구현하여 이터러블이 됨 (배열도 동일)
    

하지만 모든 유사 배열 객체가 이터러블인 것은 아님 

## 34.5 이터레이션 프로토콜의 필요성

이터러블은 for …of문, 스프레드 문법, 배열 디스트럭처링 할당과 같은 데이터 소비자에 의해 사용되므로 데이터 공급자 역할을 한다고 할 수 있음

## 34.6 사용자 정의 이터러블

```tsx
const fibonacci = {
  [Symbol.iterator]() {
    let [pre, cur] = [0, 1]
    const max = 10
		
    return {
      next() {
        [pre, cur] = [cur, pre + cur];
        return { value: cur, done: cur >= max }; 
      }
    };
  }
};

for (const num of fibonacci) {
  console.log(num);
}
```
